<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- SEO Meta Description -->
    <meta name="description" content="Malik Service Center Semarang. Spesialis servis HP, Laptop, Tablet, Elektronik. Layanan Pickup & Antar, Bergaransi, Cek Resi.">
    <meta name="theme-color" content="#2563eb">
    <title>Malik Service Center</title>
    
    <!-- Font Awesome & Google Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- VARIABLES & THEME --- */
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #10b981;
            --accent: #f59e0b;
            --danger: #ef4444;
            --light-bg: #f8fafc;
            --light-card: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            --radius: 16px;
            --nav-height: 70px;
        }

        /* Auto Dark Mode Support */
        @media (prefers-color-scheme: dark) {
            :root {
                --light-bg: #0f172a;
                --light-card: #1e293b;
                --text-main: #f1f5f9;
                --text-muted: #94a3b8;
                --border: #334155;
            }
        }

        body.manual-dark-mode {
            --light-bg: #0f172a;
            --light-card: #1e293b;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #334155;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--light-bg);
            color: var(--text-main);
            transition: background-color 0.3s, color 0.3s;
            line-height: 1.6;
            padding-bottom: calc(var(--nav-height) + 20px); /* Space for bottom nav */
        }

        /* --- UTILITIES --- */
        .hidden { display: none !important; }
        .container { max-width: 600px; margin: 0 auto; padding: 0 16px; }
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-right: 5px; }
        .badge-light { background: #dcfce7; color: #166534; }
        .badge-medium { background: #fef9c3; color: #854d0e; }
        .badge-heavy { background: #fee2e2; color: #991b1b; }
        .badge-fast { background: #dbeafe; color: #1e40af; }
        .badge-garansi { background: #f3e8ff; color: #6b21a8; }

        /* --- HEADER --- */
        header {
            background: var(--light-card);
            padding: 1rem 16px;
            position: sticky;
            top: 0;
            z-index: 50;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .brand { font-size: 1.2rem; font-weight: 700; color: var(--primary); display: flex; align-items: center; gap: 8px; }

        /* --- BOTTOM NAVIGATION (STICKY) --- */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--nav-height);
            background: var(--light-card);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 100;
            padding-bottom: env(safe-area-inset-bottom);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 0.7rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: color 0.2s;
            width: 20%;
        }
        .nav-item i { font-size: 1.3rem; margin-bottom: 4px; }
        .nav-item.active { color: var(--primary); font-weight: 600; }

        /* --- SECTIONS --- */
        .page { display: none; animation: fadeIn 0.3s ease; padding-top: 10px; padding-bottom: 20px; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- CARDS & GRID --- */
        .card { background: var(--light-card); border-radius: var(--radius); padding: 16px; margin-bottom: 16px; box-shadow: var(--shadow); border: 1px solid var(--border); }
        .card-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 8px; color: var(--primary); }
        .service-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px; }
        .service-card { background: var(--light-bg); padding: 12px; border-radius: 12px; text-align: center; cursor: pointer; border: 1px solid transparent; transition: 0.2s; }
        .service-card:hover, .service-card:active { border-color: var(--primary); background: #eff6ff; }
        .service-card i { font-size: 1.5rem; color: var(--primary); margin-bottom: 8px; display: block; }
        .service-card span { font-size: 0.85rem; font-weight: 600; display: block; }

        /* --- FORMS --- */
        .form-group { margin-bottom: 16px; }
        label { display: block; margin-bottom: 6px; font-weight: 500; font-size: 0.9rem; }
        input, select, textarea { 
            width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; 
            background: var(--light-bg); color: var(--text-main); font-size: 1rem; /* Min 14px requirement */
            min-height: 48px; /* Min touch target requirement */
        }
        input:focus, select:focus, textarea:focus { outline: 2px solid var(--primary); border-color: transparent; }
        input[readonly] { background: #f1f5f9; color: #94a3b8; cursor: default; }

        /* --- BUTTONS --- */
        .btn { 
            width: 100%; display: flex; justify-content: center; align-items: center; gap: 8px;
            padding: 14px; border-radius: 50px; border: none; font-weight: 600; font-size: 1rem;
            cursor: pointer; transition: transform 0.1s; margin-bottom: 10px;
        }
        .btn:active { transform: scale(0.98); }
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3); }
        .btn-secondary { background: var(--text-muted); color: white; }
        .btn-whatsapp { background: #25D366; color: white; box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3); }
        .btn-danger { background: var(--danger); color: white; }

        /* --- FLOATING ACTION BUTTON --- */
        .fab {
            position: fixed; bottom: calc(var(--nav-height) + 20px); right: 20px;
            width: 56px; height: 56px; border-radius: 50%;
            background: #25D366; color: white;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 90; font-size: 1.5rem; cursor: pointer;
            text-decoration: none; transition: transform 0.2s;
        }
        .fab:hover { transform: scale(1.1); }

        /* --- RECEIPT (PRINT) --- */
        .receipt-preview { 
            background: white; color: black; padding: 20px; border: 1px dashed #ccc;
            font-family: 'Courier New', monospace; margin: 20px 0; border-radius: 8px;
        }
        .rec-row { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.9rem; }
        .rec-divider { border-top: 1px dashed #000; margin: 10px 0; }
        .rec-total { font-weight: bold; font-size: 1.1rem; display: flex; justify-content: space-between; }
        
        /* --- TOAST --- */
        .toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: #333; color: white; padding: 12px 24px; border-radius: 30px;
            font-size: 0.9rem; z-index: 200; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .toast.show { opacity: 1; }

        /* --- ARTICLES --- */
        .article-item { padding: 16px; border-bottom: 1px solid var(--border); cursor: pointer; display: flex; gap: 12px; }
        .article-thumb { width: 80px; height: 80px; background: #ddd; border-radius: 8px; object-fit: cover; flex-shrink: 0; }
        .article-content h3 { margin: 0 0 6px 0; font-size: 1rem; color: var(--text-main); }
        .article-content p { margin: 0; font-size: 0.85rem; color: var(--text-muted); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        
        /* --- PICKUP BOX --- */
        .pickup-box { background: #eff6ff; padding: 16px; border-radius: 8px; border-left: 4px solid var(--primary); margin-bottom: 16px; }
        .manual-dark-mode .pickup-box { background: #1e3a8a; border-left-color: #60a5fa; }

        /* --- PRINT MEDIA (FIXED) --- */
        @media print {
            body * { visibility: hidden; }
            .receipt-wrapper, .receipt-wrapper * { visibility: visible; }
            .receipt-wrapper { position: absolute; left: 0; top: 0; width: 100%; padding: 20px; }
            header, .bottom-nav, .fab, .no-print { display: none !important; }
            .receipt-preview { border: none; box-shadow: none; padding: 0; }
        }

        /* --- MODAL (For Article Full View) --- */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--light-bg); z-index: 150; overflow-y: auto;
            display: none; padding-bottom: 20px;
        }
        .modal.open { display: block; }
        .modal-header { padding: 16px; border-bottom: 1px solid var(--border); display: flex; align-items: center; position: sticky; top: 0; background: var(--light-bg); z-index: 10; }
        .modal-body { padding: 20px 16px; max-width: 800px; margin: 0 auto; }
        .modal-body img { max-width: 100%; border-radius: 8px; margin: 10px 0; }
        .modal-body h1 { font-size: 1.5rem; color: var(--primary); margin-bottom: 10px; }
        .modal-body h2 { font-size: 1.2rem; margin-top: 20px; margin-bottom: 10px; border-left: 4px solid var(--primary); padding-left: 10px; }
    </style>
</head>
<body>

    <!-- HEADER -->
    <header>
        <div class="brand"><i class="fa-solid fa-screwdriver-wrench"></i> Malik Service</div>
        <button id="toggleTheme" style="background:none; border:none; color:var(--text-main); font-size:1.2rem;"><i class="fa-solid fa-circle-half-stroke"></i></button>
    </header>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast">Notifikasi</div>

    <!-- FLOATING WHATSAPP -->
    <a href="https://wa.me/6285713087659" class="fab" target="_blank">
        <i class="fa-brands fa-whatsapp"></i>
    </a>

    <!-- MAIN CONTENT -->
    <main class="container">

        <!-- 1. HOME (BERANDA) -->
        <section id="page-home" class="page active">
            <div class="card" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; text-align: center;">
                <h2 style="margin-bottom: 8px;">Solusi Cepat & Terpercaya</h2>
                <p style="opacity: 0.9;">Jasa servis HP, Laptop & Elektronik Bergaransi.</p>
                <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: center;">
                    <span class="badge" style="background: rgba(255,255,255,0.2); color: white;">Fast Service</span>
                    <span class="badge" style="background: rgba(255,255,255,0.2); color: white;">Garansi Resmi</span>
                </div>
            </div>

            <h3 style="margin-bottom: 12px;">Layanan Populer</h3>
            <div class="service-grid">
                <div class="service-card" onclick="navTo('order')">
                    <i class="fa-solid fa-mobile-screen"></i>
                    <span>Ganti LCD</span>
                </div>
                <div class="service-card" onclick="navTo('order')">
                    <i class="fa-solid fa-battery-full"></i>
                    <span>Baterai Baru</span>
                </div>
                <div class="service-card" onclick="navTo('order')">
                    <i class="fa-solid fa-laptop"></i>
                    <span>Laptop Mati</span>
                </div>
                <div class="service-card" onclick="navTo('order')">
                    <i class="fa-solid fa-droplet"></i>
                    <span>Water Damage</span>
                </div>
            </div>

            <button class="btn btn-primary" onclick="navTo('order')">
                Buat Order Servis Sekarang <i class="fa-solid fa-arrow-right"></i>
            </button>
        </section>

        <!-- 2. LAYANAN (SERVICES) -->
        <section id="page-services" class="page">
            <h2 style="margin-bottom: 20px;">Daftar Layanan & Harga</h2>
            <div id="services-list">
                <!-- JS Generated Services -->
            </div>
        </section>

        <!-- 3. ORDER (BOOKING) -->
        <section id="page-order" class="page">
            <h2 style="margin-bottom: 20px;">Booking Servis</h2>
            
            <div class="form-group">
                <label>Kategori Perangkat</label>
                <select id="orderCat" onchange="updateOrderForm()">
                    <option value="">-- Pilih --</option>
                    <option value="HP">Smartphone</option>
                    <option value="Tablet">Tablet / iPad</option>
                    <option value="Laptop">Laptop / PC</option>
                    <option value="Elektronik">Elektronik Rumah</option>
                </select>
            </div>

            <div class="form-group">
                <label>Jenis Kerusakan</label>
                <select id="orderDamage" onchange="calculateEstimate()">
                    <option value="">-- Pilih --</option>
                </select>
            </div>

            <!-- Estimate Display -->
            <div id="estimateBox" class="card hidden" style="border-left: 4px solid var(--primary);">
                <div style="display:flex; justify-content:space-between; font-weight:bold; font-size:1.1rem;">
                    <span>Estimasi:</span>
                    <span id="estPrice">Rp 0</span>
                </div>
                <div style="margin-top:8px; font-size:0.85rem;">
                    <span id="estTime">-</span> | <span id="estSeverity" class="badge badge-light">-</span>
                </div>
            </div>

            <!-- Pickup Section -->
            <div class="form-group" style="display:flex; align-items:center; gap:10px;">
                <input type="checkbox" id="needPickup" style="width:auto;" onchange="togglePickup()">
                <label for="needPickup" style="margin:0;">Butuh Pickup & Antar?</label>
            </div>

            <div id="pickupDetail" class="pickup-box hidden">
                <label>Jarak (km)</label>
                <input type="number" id="pickupDist" placeholder="Cth: 3" oninput="calculateEstimate()">
                <p id="pickupFeeText" style="margin-top:5px; font-weight:600; color:var(--primary);">Biaya Pickup: Rp 0</p>
                <small style="color:var(--text-muted);">*Biaya Rp 25.000 untuk < 5km. > 5km Hubungi Admin.</small>
            </div>

            <!-- Customer Data -->
            <div class="card">
                <h4 style="margin-bottom:12px;">Data Diri</h4>
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" id="custName">
                </div>
                <div class="form-group">
                    <label>Nomor WhatsApp</label>
                    <input type="tel" id="custWA">
                </div>
                <div class="form-group">
                    <label>Alamat Lengkap</label>
                    <textarea id="custAddress" rows="2"></textarea>
                </div>
                <button class="btn btn-whatsapp" onclick="sendOrder()">
                    <i class="fa-brands fa-whatsapp"></i> Kirim Order ke WA
                </button>
            </div>
        </section>

        <!-- 4. ARTIKEL (ARTICLES) -->
        <section id="page-articles" class="page">
            <h2 style="margin-bottom: 20px;">Artikel & Tips Elektronik</h2>
            <div id="article-list-container">
                <!-- JS Generated Articles -->
            </div>
        </section>

        <!-- 5. RESI / ADMIN (RECEIPT) -->
        <section id="page-admin" class="page">
            <!-- Login Form -->
            <div id="admin-login" class="card">
                <h2><i class="fa-solid fa-lock"></i> Area Admin</h2>
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="admUser">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="admPass">
                </div>
                <button class="btn btn-primary" onclick="adminLogin()">Masuk</button>
            </div>

            <!-- Admin Panel -->
            <div id="admin-panel" class="hidden">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <h2>Buat Resi</h2>
                    <button class="btn btn-secondary" style="width:auto; padding:8px 16px;" onclick="adminLogout()">Keluar</button>
                </div>

                <div class="form-group">
                    <label>No. Order</label>
                    <input type="text" id="resId" readonly>
                </div>
                <div class="form-group">
                    <label>Nama Pelanggan</label>
                    <input type="text" id="resName" oninput="updateReceipt()">
                </div>
                <div class="form-group">
                    <label>Perangkat</label>
                    <input type="text" id="resDev" oninput="updateReceipt()">
                </div>
                <div class="form-group">
                    <label>Keluhan</label>
                    <input type="text" id="resIssue" oninput="updateReceipt()">
                </div>
                <div class="form-group">
                    <label>Biaya Total</label>
                    <input type="number" id="resPrice" oninput="updateReceipt()">
                </div>

                <!-- ACTION BUTTONS -->
                <div style="margin-top:20px;">
                    <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:10px;">*Pilih metode penyimpanan resi:</p>
                    <button class="btn btn-primary" onclick="printReceipt()">
                        <i class="fa-solid fa-print"></i> Cetak / Save PDF
                    </button>
                    <button class="btn btn-secondary" onclick="openInBrowser()">
                        <i class="fa-solid fa-globe"></i> Buka Resi di Browser
                    </button>
                    <button class="btn btn-secondary" onclick="copyReceiptText()">
                        <i class="fa-solid fa-copy"></i> Salin Teks Resi
                    </button>
                </div>

                <!-- RECEIPT PREVIEW -->
                <div class="receipt-wrapper" style="margin-top:30px;">
                    <h4 style="text-align:center; margin-bottom:10px; color:var(--text-muted);">Preview Cetak</h4>
                    <div class="receipt-preview">
                        <div style="text-align:center; border-bottom:2px dashed #000; padding-bottom:10px; margin-bottom:15px;">
                            <i class="fa-solid fa-screwdriver-wrench" style="font-size:2rem; color:black;"></i>
                            <h3 style="margin:5px 0; text-transform:uppercase;">MALIK SERVICE</h3>
                            <p style="font-size:0.8rem; margin:0;">DS. JamalSari RT004/RW002 No.52, Semarang</p>
                            <p style="font-size:0.8rem; margin:0;">WA: 0857-1308-7659</p>
                        </div>
                        <div class="rec-row"><span>Tgl:</span> <span id="viewDate">-</span></div>
                        <div class="rec-row"><span>No. Order:</span> <span id="viewId">-</span></div>
                        <div class="rec-divider"></div>
                        <div class="rec-row"><span>Pelanggan:</span> <span id="viewName">-</span></div>
                        <div class="rec-row"><span>Perangkat:</span> <span id="viewDev">-</span></div>
                        <div class="rec-row"><span>Keluhan:</span> <span id="viewIssue">-</span></div>
                        <div class="rec-divider"></div>
                        <div class="rec-total"><span>TOTAL:</span> <span id="viewPrice">Rp 0</span></div>
                        <div style="text-align:center; margin-top:15px; font-size:0.75rem;">
                            *Simpan sebagai bukti garansi.<br>Terima Kasih.
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- BOTTOM NAVIGATION -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="navTo('home')">
            <i class="fa-solid fa-house"></i>
            <span>Beranda</span>
        </div>
        <div class="nav-item" onclick="navTo('services')">
            <i class="fa-solid fa-list"></i>
            <span>Layanan</span>
        </div>
        <div class="nav-item" onclick="navTo('order')">
            <i class="fa-solid fa-calendar-check"></i>
            <span>Order</span>
        </div>
        <div class="nav-item" onclick="navTo('articles')">
            <i class="fa-solid fa-newspaper"></i>
            <span>Artikel</span>
        </div>
        <div class="nav-item" onclick="navTo('admin')">
            <i class="fa-solid fa-file-invoice"></i>
            <span>Resi</span>
        </div>
    </nav>

    <!-- ARTICLE MODAL -->
    <div id="articleModal" class="modal">
        <div class="modal-header">
            <i class="fa-solid fa-arrow-left" style="font-size:1.5rem; color:var(--text-main); cursor:pointer;" onclick="closeModal()"></i>
        </div>
        <div id="articleContent" class="modal-body">
            <!-- Content Injected Here -->
        </div>
    </div>

    <script>
        /* --- 1. DATABASE LAYANAN LENGKAP --- */
        const serviceDB = [
            // HP
            { cat: "HP", name: "Ganti LCD Non-Ori", price: 150000, severity: "Sedang", time: "1 Jam", badge: "Fast" },
            { cat: "HP", name: "Ganti LCD Original", price: 450000, severity: "Sedang", time: "2 Jam" },
            { cat: "HP", name: "Ganti Baterai", price: 120000, severity: "Ringan", time: "30 Menit", badge: "Fast" },
            { cat: "HP", name: "IC Power / Mati Total", price: 250000, severity: "Berat", time: "2-3 Hari" },
            { cat: "HP", name: "Servis Kena Air", price: 75000, severity: "Berat", time: "1-2 Hari", badge: "Garansi" },
            { cat: "HP", name: "Unlock / Flash FRP", price: 80000, severity: "Ringan", time: "1 Jam" },
            { cat: "HP", name: "Data Recovery", price: 250000, severity: "Berat", time: "Estimasi" },
            { cat: "HP", name: "Ganti Kamera/Speaker", price: 80000, severity: "Ringan", time: "30 Menit" },
            // Laptop
            { cat: "Laptop", name: "Install Ulang OS", price: 100000, severity: "Ringan", time: "2 Jam" },
            { cat: "Laptop", name: "Upgrade SSD/RAM", price: 150000, severity: "Ringan", time: "1 Jam" },
            { cat: "Laptop", name: "Ganti Keyboard/LCD", price: 400000, severity: "Sedang", time: "3 Jam" },
            { cat: "Laptop", name: "Cleaning Overheat", price: 100000, severity: "Ringan", time: "1 Jam" },
            // Tablet & Elektronik
            { cat: "Tablet", name: "Ganti Layar Tablet", price: 350000, severity: "Sedang", time: "2 Hari" },
            { cat: "Elektronik", name: "Servis Kulkas", price: 150000, severity: "Berat", time: "Home Visit" },
            { cat: "Elektronik", name: "Servis AC", price: 150000, severity: "Berat", time: "Home Visit" }
        ];

        /* --- 2. DATABASE ARTIKEL (30 STRUKTUR) --- */
        const articles = [
            { title: "HP Tidak Bisa Di-charge? Ini Penyebabnya", cat: "Tips HP", img: "ðŸ”Œ", content: "Masalah charging sering terjadi. Penyebab umum: kabel putus, port kotor, atau IC Power rusak. Cek dulu kabel Anda di HP lain." },
            { title: "LCD Retak Masih Bisa Dipakai?", cat: "Tips HP", img: "ðŸ“±", content: "Layar retak masih bisa dipakai jika sentuh jalan dan LCD tidak bocor (biru/hitam). Namun segera ganti agar kaca tidak melukai jari." },
            { title: "Cara Backup Data Sebelum Servis", cat: "Edukasi", img: "â˜ï¸", content: "Penting membackup data. Android: Gunakan Google Photo/Drive. iPhone: Gunakan iCloud. Jangan lupa ingat password iCloud Anda." },
            { title: "Baterai Boros Padahal Baru", cat: "Tips HP", img: "ðŸ”‹", content: "Baterai boros bisa disebabkan oleh aplikasi latar belakang, sinyal lemah, atau baterai palsu/rekondisi." },
            { title: "Lambat? Cek Storage Anda", cat: "Tips Laptop", img: "ðŸ’¾", content: "Storage penuh membuat HP/Laptop lambat. Hapus cache, foto/video tidak penting ke Cloud, atau uninstall aplikasi jarang dipakai." },
            { title: "Mati Total: Bisa Selamat?", cat: "Kerusakan Umum", img: "âš¡", content: "Mati total (matot) biasanya karena IC Power short. Bisa diperbaiki dengan cara reballing atau ganti IC, asalkan kondisi motherboard masih bagus." },
            { title: "Kenapa HP Cepat Panas?", cat: "Tips HP", img: "ðŸ”¥", content: "Main game berat, casan sambil main, atau suhu ruangan panas. Gunakan cooling fan atau istirahatkan HP sesaat." },
            { title: "Speaker Suara Pecah", cat: "Kerusakan Umum", img: "ðŸ”Š", content: "Speaker pecah biasanya karena debu masuk membrane atau kabel putus. Bisa dibersihkan atau diganti modul speaker." },
            { title: "Kamera Blur / Error", cat: "Kerusakan Umum", img: "ðŸ“¸", content: "Blur bisa karena kotor di lensa atau modul kamera rusak. Coba bersihkan lensa dulu dengan kain microfiber." },
            { title: "Kena Air, Apa Yang Harus Dilakukan?", cat: "Tips HP", img: "ðŸ’§", content: "MATIKAN HP SEKARANG. Jangan nyalakan. Jangan goyang-goyang. Bawa segera ke teknisi untuk dilakukan pembersihan (ultrasonic cleaner)." },
            { title: "Lupa Pola / Password", cat: "Edukasi", img: "ðŸ”’", content: "Jangan direset sembarangan di recovery mode karena data akan hilang. Bisa dibuka lewat Flashing tool atau buka akun Google (FRP)." },
            { title: "Estimasi Biaya Ganti LCD", cat: "Estimasi Harga", img: "ðŸ’°", content: "HP Low End: 150-250rb. HP Mid End: 250-400rb. HP High End (Ori): 500rb keatas. Tergantung tipe." },
            { title: "Upgrade SSD Worth It?", cat: "Tips Laptop", img: "ðŸš€", content: "Sangat worth it! Upgrade SSD dari HDD membuat booting Windows 3x lebih cepat dan aplikasi ringan loading sekejap." },
            { title: "IC Touchscreen Rusak", cat: "Kerusakan Umum", img: "ðŸ‘†", content: "Sentuh bergerak sendiri (ghost touch) atau sebagian tidak respon. Biasanya diakibatkan IC Touch short karena benturan." },
            { title: "Sinyal Hilang / No Service", cat: "Kerusakan Umum", img: "ðŸ“¶", content: "Cek dulu kartu SIM di HP lain. Jika kartu normal, berarti masalah di jalur RF, IC PA, atau Konektor Antena." },
            { title: "Jarak Pantang Layar (Green Screen)", cat: "Kerusakan Umum", img: "ðŸŸ¢", content: "Tampilan hijau/pink bercak. Masalah pada kabel fleksibel LCD lepas atau koneksi IC Display longgar." },
            { title: "Servis TV Gelap Suara Ada", cat: "Kerusakan Umum", img: "ðŸ“º", content: "Biasanya Backlight LED mati. Bisa diganti modul backlight atau cek elco di power supply." },
            { title: "Kipas Angin Berisik", cat: "Tips Rumah", img: "ðŸ’¨", content: "Berisik karena bearing dinamo aus. Minyak pelumas sudah kering. Bisa ditambah minyak bearing atau ganti dinamo." },
            { title: "Mesin Cuci Tidak Berputar", cat: "Kerusakan Umum", img: "ðŸ§º", content: "Cek kapasitor, dinamo, atau modul timer. Jika hanya bunyi 'klik-klik', biasanya kapasitor lemah." },
            { title: "Kulkas Tidak Dingin", cat: "Kerusakan Umum", img: "â„ï¸", content: "Freon bocor? Kompresor mati? Atau timer defrost rusak? Segera cek agar makanan tidak basi." },
            { title: "Garansi Resi Hilang", cat: "Edukasi", img: "ðŸ“", content: "Jika resi hilang, kami tetap bisa cek data di buku catatan kami berdasarkan nama dan nomor HP saat pendaftaran." },
            { title: "Perbedaan LCD Ori & Copy", cat: "Edukasi", img: "ðŸ–¼ï¸", content: "Ori: Warna tajam, sentuh mulus, awet. Copy: Warna agak kehijauan, kadang sentuh sensitif, harga murah." },
            { title: "Flash Ulang Bisa Hilang Data?", cat: "Edukasi", img: "âš ï¸", content: "Ya. Flash ulang (Install OS) memformat memori internal. Backup data dulu sebelum melakukan flashing." },
            { title: "Mic Tidak Terdengar Saat Telpon", cat: "Kerusakan Umum", img: "ðŸŽ¤", content: "Bisa karena mic kotor debu, lubang mic tertutup casing, atau modul mic putus. Cek recording dulu." },
            { title: "Vibrator Rusak", cat: "Kerusakan Umum", img: "ðŸ“³", content: "HP tidak bergetar saat ada notifikasi. Ganti motor vibrator. Murah dan cepat." },
            { title: "Install Ulang vs Reset Pabrik", cat: "Edukasi", img: "ðŸ”„", content: "Reset pabrik: Kembali ke pengaturan awal (Windows masih ada). Install ulang: Hapus OS lama pasang baru." },
            { title: "Charger Original vs KW", cat: "Tips HP", img: "ðŸ”Œ", content: "Charger KW arus tidak stabil. Bisa merusak baterai (kembung) atau IC Power dalam jangka panjang." },
            { title: "Layar Berbayang / Miring", cat: "Kerusakan Umum", img: "ðŸ“‰", content: "Tanda LCD mulai rusak (kaca mulai lepas dari polarizer). Sebaiknya segera diganti sebelum hitam total." },
            { title: "WiFi Tidak Konek", cat: "Kerusakan Umum", img: "ðŸ“¡", content: "Cek dulu di HP lain. Kalau router normal, berarti IC WiFi di HP bermasalah atau perlu ganti antena pogo pin." },
            { title: "Tips Rawat Baterai Awet", cat: "Tips HP", img: "ðŸ”‹", content: "Jangan biarkan baterai 0% seringkali. Cas saat 20% dan stop saat 90-95% untuk umur baterai panjang." },
            { title: "Kartu SD Tidak Terbaca", cat: "Kerusakan Umum", img: "ðŸ’¾", content: "Bisa karena file system corrupt, kartu mati, atau slot bacaan kotor. Coba diformat dulu di laptop." }
        ];

        /* --- 3. NAVIGATION LOGIC --- */
        function navTo(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            // Show target
            document.getElementById('page-' + pageId).classList.add('active');
            
            // Update nav active state
            const index = ['home', 'services', 'order', 'articles', 'admin'].indexOf(pageId);
            if(index !== -1) document.querySelectorAll('.nav-item')[index].classList.add('active');

            window.scrollTo(0,0);
        }

        /* --- 4. RENDER SERVICES --- */
        function renderServices() {
            const container = document.getElementById('services-list');
            let html = '';
            
            // Group by Category
            const categories = [...new Set(serviceDB.map(item => item.cat))];
            
            categories.forEach(cat => {
                html += `<h3 style="margin:20px 0 10px 0; color:var(--primary);">${cat}</h3>`;
                serviceDB.filter(item => item.cat === cat).forEach(item => {
                    let badges = '';
                    if(item.severity === 'Berat') badges += `<span class="badge badge-heavy">${item.severity}</span>`;
                    else if(item.severity === 'Sedang') badges += `<span class="badge badge-medium">${item.severity}</span>`;
                    else badges += `<span class="badge badge-light">${item.severity}</span>`;
                    
                    if(item.badge === 'Fast') badges += `<span class="badge badge-fast">Fast</span>`;
                    
                    html += `
                    <div class="card" style="padding:12px; display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <div style="font-weight:600;">${item.name}</div>
                            <div style="font-size:0.8rem; margin:4px 0;">${badges}</div>
                            <div style="font-size:0.75rem; color:var(--text-muted);">Estimasi: ${item.time}</div>
                        </div>
                        <div style="font-weight:bold; color:var(--primary);">${formatRupiah(item.price)}</div>
                    </div>`;
                });
            });
            container.innerHTML = html;
        }

        /* --- 5. RENDER ARTICLES --- */
        function renderArticles() {
            const container = document.getElementById('article-list-container');
            let html = '';
            articles.forEach((art, idx) => {
                html += `
                <div class="article-item" onclick="openArticle(${idx})">
                    <div style="font-size:2rem; display:flex; align-items:center; justify-content:center; width:60px; height:60px; background:#f1f5f9; border-radius:8px;">${art.img}</div>
                    <div style="flex:1;">
                        <h3>${art.title}</h3>
                        <p>${art.content}</p>
                        <span class="badge" style="background:var(--border); margin-top:5px;">${art.cat}</span>
                    </div>
                </div>`;
            });
            container.innerHTML = html;
        }

        function openArticle(idx) {
            const art = articles[idx];
            const modal = document.getElementById('articleModal');
            const content = document.getElementById('articleContent');
            
            content.innerHTML = `
                <h1>${art.img} ${art.title}</h1>
                <span class="badge badge-garansi">${art.cat}</span>
                <p style="margin-top:10px; font-size:1rem;">${art.content}</p>
                <div style="margin-top:30px; padding:20px; background:var(--light-bg); border-radius:8px; text-align:center;">
                    <h3>Butuh bantuan langsung?</h3>
                    <p>Hubungi teknisi kami untuk konsultasi gratis.</p>
                    <a href="https://wa.me/6285713087659" target="_blank" class="btn btn-whatsapp" style="margin-top:10px;">
                        <i class="fa-brands fa-whatsapp"></i> Chat WhatsApp
                    </a>
                </div>
            `;
            modal.classList.add('open');
        }

        function closeModal() {
            document.getElementById('articleModal').classList.remove('open');
        }

        /* --- 6. ORDER LOGIC --- */
        function updateOrderForm() {
            const cat = document.getElementById('orderCat').value;
            const dmgSelect = document.getElementById('orderDamage');
            dmgSelect.innerHTML = '<option value="">-- Pilih --</option>';
            document.getElementById('estimateBox').classList.add('hidden');

            if(!cat) return;

            serviceDB.filter(s => s.cat === cat).forEach(item => {
                const opt = document.createElement('option');
                opt.value = JSON.stringify(item);
                opt.text = item.name;
                dmgSelect.appendChild(opt);
            });
        }

        function calculateEstimate() {
            const dmgVal = document.getElementById('orderDamage').value;
            const estBox = document.getElementById('estimateBox');
            
            if(!dmgVal) {
                estBox.classList.add('hidden');
                return;
            }

            const data = JSON.parse(dmgVal);
            let total = data.price;

            // Pickup Logic
            const needPickup = document.getElementById('needPickup').checked;
            const dist = parseFloat(document.getElementById('pickupDist').value) || 0;
            let pickupFee = 0;

            if(needPickup && dist > 0 && dist < 5) {
                pickupFee = 25000;
                document.getElementById('pickupFeeText').innerText = "Biaya Pickup: Rp 25.000";
            } else if (needPickup && dist >= 5) {
                document.getElementById('pickupFeeText').innerText = "Jarak > 5km: Hubungi Admin";
            } else {
                document.getElementById('pickupFeeText').innerText = "Biaya Pickup: Rp 0";
            }

            const grandTotal = total + pickupFee;
            
            // UI Updates
            document.getElementById('estPrice').innerText = formatRupiah(grandTotal);
            document.getElementById('estTime').innerText = data.time;
            document.getElementById('estSeverity').innerText = data.severity;
            
            if(data.severity === 'Berat') document.getElementById('estSeverity').className = 'badge badge-heavy';
            else if(data.severity === 'Sedang') document.getElementById('estSeverity').className = 'badge badge-medium';
            else document.getElementById('estSeverity').className = 'badge badge-light';

            estBox.classList.remove('hidden');
        }

        function togglePickup() {
            const isChecked = document.getElementById('needPickup').checked;
            const detail = document.getElementById('pickupDetail');
            detail.style.display = isChecked ? 'block' : 'none';
            calculateEstimate();
        }

        function sendOrder() {
            const name = document.getElementById('custName').value;
            const wa = document.getElementById('custWA').value;
            const dmgVal = document.getElementById('orderDamage').value;
            const addr = document.getElementById('custAddress').value;

            if(!name || !wa) { showToast("Nama dan WA wajib diisi!"); return; }
            if(!dmgVal) { showToast("Pilih kerusakan dulu!"); return; }

            const data = JSON.parse(dmgVal);
            const needPickup = document.getElementById('needPickup').checked;
            const dist = document.getElementById('pickupDist').value;
            let pickupMsg = "";

            if(needPickup) {
                if(dist < 5) pickupMsg = `\n\n*PICKUP & ANTAR*\nJarak: ${dist} km (+Rp 25.000)`;
                else pickupMsg = `\n\n*PICKUP & ANTAR*\nJarak: ${dist} km (Mohon konfirmasi ke admin karena > 5km)`;
            }

            const msg = `Halo Admin, saya mau servis.\n\n*Nama:* ${name}\n*Alamat:* ${addr}\n*Kerusakan:* ${data.name}\n*Estimasi:* ${formatRupiah(data.price)}${pickupMsg}`;
            
            window.open(`https://wa.me/6285713087659?text=${encodeURIComponent(msg)}`, '_blank');
        }

        /* --- 7. ADMIN & RECEIPT (NO HTML2CANVAS) --- */
        function adminLogin() {
            const u = document.getElementById('admUser').value;
            const p = document.getElementById('admPass').value;
            // Simple dummy check for demo
            if(u === 'admin' && p === 'admin') {
                document.getElementById('admin-login').classList.add('hidden');
                document.getElementById('admin-panel').classList.remove('hidden');
                document.getElementById('resId').value = "RESI-" + Date.now();
                document.getElementById('viewDate').innerText = new Date().toLocaleDateString('id-ID');
                showToast("Login Berhasil");
            } else {
                showToast("Username/Password Salah (Coba: admin/admin)");
            }
        }

        function adminLogout() {
            document.getElementById('admin-login').classList.remove('hidden');
            document.getElementById('admin-panel').classList.add('hidden');
        }

        function updateReceipt() {
            document.getElementById('viewName').innerText = document.getElementById('resName').value;
            document.getElementById('viewDev').innerText = document.getElementById('resDev').value;
            document.getElementById('viewIssue').innerText = document.getElementById('resIssue').value;
            const price = document.getElementById('resPrice').value;
            document.getElementById('viewPrice').innerText = formatRupiah(price);
            document.getElementById('viewId').innerText = document.getElementById('resId').value;
        }

        function printReceipt() {
            // THE SOLUTION FOR WEBVIEW: Native Print to PDF
            window.print();
        }

        function openInBrowser() {
            // Opens current receipt in new window (Browser usually handles _blank)
            window.open(window.location.href + '#page-admin', '_blank');
        }

        function copyReceiptText() {
            const text = `RESI MALIK SERVICE\nNo: ${document.getElementById('resId').value}\nNama: ${document.getElementById('resName').value}\nPerangkat: ${document.getElementById('resDev').value}\nKeluhan: ${document.getElementById('resIssue').value}\nTotal: ${formatRupiah(document.getElementById('resPrice').value)}\n\nSimpan bukti ini untuk klaim garansi.`;
            navigator.clipboard.writeText(text).then(() => showToast("Teks disalin!"));
        }

        /* --- 8. UTILS --- */
        function formatRupiah(num) {
            return "Rp " + parseInt(num).toLocaleString('id-ID');
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3000);
        }

        document.getElementById('toggleTheme').addEventListener('click', () => {
            document.body.classList.toggle('manual-dark-mode');
        });

        // INIT
        renderServices();
        renderArticles();
    </script>
</body>
</html>
